{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    <div id="progress"></div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-list"></i> {{ text_list }}</h3>
      </div>
      <div class="panel-body">
        <div class="table-responsive">
          <table id="ps-lightbox" style="min-width:100% !important;" class="table table-bordered table-hover">
            <thead>
              <tr>
                <th style="min-width: 80px !important;" class="text-center">{{ column_order_id }}</th>
                <th style="min-width: 120px !important;" class="text-center">{{ column_date_added }}</th>
                <th style="min-width: 200px !important;" class="text-left">{{ column_customer }}</th>
                <th style="min-width: 100px !important;" class="text-center">{{ column_metodo }}</th>
                <th style="min-width: 120px !important;" class="text-center">{{ column_status }}</th>
                <th style="min-width: 100px !important;" class="text-center">{{ column_action }}</th>
              </tr>
            </thead>
            <tbody>
              {% if transactions %}
              {% for transaction in transactions %}
              <tr>
                <td class="text-center"><a href="{{ transaction.view_order }}">{{ transaction.order_id }}</a></td>
                <td class="text-center">{{ transaction.date_added }}</td>
                <td class="text-left">{{ transaction.customer }}</td>
                <td class="text-center">{{ transaction.metodo }}</td>
                <td class="text-center">{{ transaction.status }}</td>
                <td class="text-center">
                  {% for action in transaction.action %}
                  <button type="button" data-toggle="tooltip" title="{{ action.title }}" class="{{ action.class }}" name="{{ action.name }}" id="{{ action.id }}"><i class="{{ action.icon }}"></i></button>
                  {% endfor %}
                </td>
              </tr>
              {% endfor %}
              {% else %}
              <tr>
                <td class="text-center" colspan="6">{{ text_no_results }}</td>
              </tr>
              {% endif %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript"><!--
    $(document).ready(function() {
      $('#ps-lightbox').DataTable({
        "order": [],
        "columnDefs": [ {"targets": 5, "searchable": false, "orderable": false} ],
        "language": {
          "url": "//cdn.datatables.net/plug-ins/1.10.19/i18n/Portuguese-Brasil.json"
        }
      });
    });
    $('button[name=\'button-consultar\']').on('click', function() {
      if (confirm('{{ text_confirmacao }}')) {
        $.ajax({
          url: 'index.php?route=extension/paymee/list/consultar&user_token={{ user_token }}&paymee_id=' + $(this).attr('id'),
          dataType: 'json',
          beforeSend: function() {
            $(this).prop('disabled', true);
            $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> {{ text_consultando }} <img src="view/image/paymee/spinner.gif" alt="" /><button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            $('html, body').animate({ scrollTop: 0 }, 'slow');
          },
          complete: function() {
            $(this).prop('disabled', false);
          },
          success: function(json) {
            $('html, body').animate({ scrollTop: 0 }, 'slow');
            if (json['error']) {
              $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '<button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            } else {
              $('.alert alert-danger').remove();
              $('#progress').html('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
              location.href = location.href;
            }
          }
        });
      }
    });
    $('button[name=\'button-cancelar\']').on('click', function() {
      if (confirm('{{ text_confirmacao }}')) {
        $.ajax({
          url: 'index.php?route=extension/paymee/list/cancelar&user_token={{ user_token }}&paymee_id=' + $(this).attr('id'),
          dataType: 'json',
          beforeSend: function() {
            $(this).prop('disabled', true);
            $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> {{ text_cancelando }} <img src="view/image/paymee/spinner.gif" alt="" /><button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            $('html, body').animate({ scrollTop: 0 }, 'slow');
          },
          complete: function() {
            $(this).prop('disabled', false);
          },
          success: function(json) {
            $('html, body').animate({ scrollTop: 0 }, 'slow');
            if (json['error']) {
              $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '<button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            } else {
              $('.alert alert-danger').remove();
              $('#progress').html('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
              location.href = location.href;
            }
          }
        });
      }
    });
    $('button[name=\'button-reembolsar\']').on('click', function() {
      if (confirm('{{ text_confirmacao }}')) {
        $.ajax({
          url: 'index.php?route=extension/paymee/list/reembolsar&user_token={{ user_token }}&paymee_id=' + $(this).attr('id'),
          dataType: 'json',
          beforeSend: function() {
            $(this).prop('disabled', true);
            $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> {{ text_reembolsando }} <img src="view/image/paymee/spinner.gif" alt="" /><button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            $('html, body').animate({ scrollTop: 0 }, 'slow');
          },
          complete: function() {
            $(this).prop('disabled', false);
          },
          success: function(json) {
            $('html, body').animate({ scrollTop: 0 }, 'slow');
            if (json['error']) {
              $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '<button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            } else {
              $('.alert alert-danger').remove();
              $('#progress').html('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
              location.href = location.href;
            }
          }
        });
      }
    });
    $('button[name=\'button-excluir\']').on('click', function() {
      if (confirm('{{ text_confirmacao }}')) {
        $.ajax({
          url: 'index.php?route=extension/paymee/list/excluir&user_token={{ user_token }}&paymee_id=' + $(this).attr('id'),
          dataType: 'json',
          beforeSend: function() {
            $(this).prop('disabled', true);
            $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> {{ text_excluindo }} <img src="view/image/paymee/spinner.gif" alt="" /><button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            $('html, body').animate({ scrollTop: 0 }, 'slow');
          },
          complete: function() {
            $(this).prop('disabled', false);
          },
          success: function(json) {
            $('html, body').animate({ scrollTop: 0 }, 'slow');
            if (json['error']) {
              $('#progress').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '<button type="button" class="close" data-dismiss="alert">&times;</button></div>');
            } else {
              $('.alert alert-danger').remove();
              $('#progress').html('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
              location.href = location.href;
            }
          }
        });
      }
    });
  //--></script>
</div>
{{ footer }}